{% extends "DataHub/base.html" %}
{% block content %}

<div class="content">
    <div class="row m-0">
        <div class="col-2 m-0 pt-3" style="background-color: rgb(17, 99, 171);">
            <center>
                <h6>Client ID</h6>
                <h5>{{ clientID }}</h5>
            </center>
        </div>
        <div class="col m-0">
            <div class="row m-0 mt-3">
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-3">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <h5 class="font-weight-bolder">Familles favorites
                                    <span style="float: right; font-size: 25px; color: #A1C9F1;">
                                        <i class="fa fa-ship"></i>
                                    </span>
                                </h5>
                            </div>
                            <div class="row">
                                <div class="col-9" style="font-size: 13px;">{{ mostFamilles.index.0|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #A1C9F1;"><b>{{ mostFamilles.data.0 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-9" style="font-size: 13px;">{{ mostFamilles.index.1|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #A1C9F1;"><b>{{ mostFamilles.data.1 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostFamilles.index.2|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #A1C9F1;"><b>{{ mostFamilles.data.2 }}</b></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-3">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <h5 class="font-weight-bolder">Univers favoris
                                    <span style="float: right; font-size: 25px; color: #FFABAB;">
                                        <i class="fa fa-warehouse"></i>
                                    </span>
                                </h5>
                            </div>
                            <div class="row">
                                <div class="col-9" style="font-size: 13px;">{{ mostUnivers.index.0|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #FFABAB;"><b>{{ mostUnivers.data.0 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-9" style="font-size: 13px;">{{ mostUnivers.index.1|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #FFABAB;"><b>{{ mostUnivers.data.1 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-9" style="font-size: 13px;">{{ mostUnivers.index.2|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #FFABAB;"><b>{{ mostUnivers.data.2 }}</b></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-3">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <h5 class="font-weight-bolder">Mailles favorites
                                    <span style="float: right; font-size: 25px; color: #C0DFB1;">
                                        <i class="fa fa-truck"></i>
                                    </span>
                                </h5>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostMailles.index.0|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #C0DFB1;"><b>{{ mostMailles.data.0 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostMailles.index.1|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #C0DFB1;"><b>{{ mostMailles.data.1 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostMailles.index.2|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #C0DFB1;"><b>{{ mostMailles.data.2 }}</b></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-3">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <h5 class="font-weight-bolder">Articles favorites
                                    <span style="float: right; font-size: 25px; color: #957DAD;">
                                        <i class="fa fa-box"></i>
                                    </span>
                                </h5>
                                
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostArticles.index.0|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #957DAD;"><b>{{ mostArticles.data.0 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostArticles.index.1|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #957DAD;"><b>{{ mostArticles.data.1 }}</b></div>
                            </div>
                            <div class="row">
                                <div class="col-10" style="font-size: 13px;">{{ mostArticles.index.2|slice:"0:25" }}</div>
                                <div class="col" style="text-align: right; color: #957DAD;"><b>{{ mostArticles.data.2 }}</b></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row m-0 mt-3">
                <div class="col-xl-4 col-sm-8 mb-xl-0 mb-3">
                    <div class="card">
                        <p class="text-center">
                            Articles achétés par mois
                        </p>
                        <canvas id="myChart" class="mb-2"> </canvas>
                    </div>
                </div>
                <div class="col-xl-4 col-sm-8 mb-xl-0 mb-3">
                    <div class="card">
                        <p class="text-center">
                            Total dépensé par mois
                        </p>
                        <canvas id="myChartLineChart" class="mb-2"> </canvas>
                    </div>
                </div>
                <div class="col-xl-4 col-sm-8 mb-xl-0 mb-3">
                    <div class="card">
                        <p class="text-center">
                            Nombre d'achats par mois
                        </p>
                        <canvas id="myChartMailles" class="mb-2"> </canvas>
                    </div>
                </div>
            </div>


            <div class="row m-0 mt-3">
                <div class="col mb-xl-0 mb-3">
                    <div class="card col p-4">
                        <table id="myTable" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Commande</th>
                                    <th>Mois</th>
                                    <th>Articles</th>
                                    <th>Prix</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for commande in commandesClient %}
                                <tr>
                                    <td>{{ commande.TICKET_ID }}</td>
                                    <td>{{ commande.MOIS_VENTE }}</td>
                                    <td>{{ commande.NOMBRE_ARTICLES }}</td>
                                    <td>{{ commande.PRIX_TOTAL }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script>

    $(document).ready(function() {
        $('#myTable').DataTable({
            "order": [[ 0, "desc" ]],
            "bDestroy": true

        });
    } );


    const ctx = document.getElementById('myChart');
    const ctxLineChart = document.getElementById('myChartLineChart');
    const ctxMailleChart = document.getElementById('myChartMailles');
    var labels = ['Janvier', 'Fevrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Aout', 'Septembre', 'Octobre', 'Novembre', 'Decembre']
    var priceByMonth = JSON.parse("{{priceByMonth|safe}}");
    var totalByMonth = JSON.parse("{{totalByMonth|safe}}");


    const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                data: totalByMonth,
                backgroundColor: ['rgba(21, 119, 64, 0.2)'],
                borderWidth: 0,
                borderRadius: 5,
            }]
        },
        options: {
            scales: {
                x: {
                    grid: {
                        display: false,
                    },
                },
                y: {
                    grid: {
                        display: false,
                    },
                    beginAtZero: true
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    }); myChartMailles

    const myChartLineChart = new Chart(ctxLineChart, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                data: priceByMonth,
                backgroundColor: [
                    'rgba(21, 119, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(21, 119, 64, 0.2)'
                ],
                borderWidth: 2
            }]
        },
        options: {
            scales: {
                x: {
                    grid: {
                        display: false,
                    },
                },
                y: {
                    grid: {
                        display: false,
                    },
                    beginAtZero: true
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });

    const JanuaryUserBoughtMail0 = 41;
    const FebruaryUserBoughtMail0 = 21;
    const MarchUserBoughtMail0 = 520;
    const AprilUserBoughtMail0 = 120;
    const MayUserBoughtMail0 = 323;
    const JuneUserBoughtMail0 = 64;
    const JulyUserBoughtMail0 = 52;
    const AugustUserBoughtMail0 = 121;
    const SeptemberUserBoughtMail0 = 229;
    const OctoberUserBoughtMail0 = 32;
    const NovemberUserBoughtMail0 = 0;
    const DecemberUserBoughtMail0 = 250;
    let mailData = [
        // "Fruits",
        JanuaryUserBoughtMail0,
        FebruaryUserBoughtMail0,
        MarchUserBoughtMail0,
        AprilUserBoughtMail0,
        MayUserBoughtMail0,
        JuneUserBoughtMail0,
        JulyUserBoughtMail0,
        AugustUserBoughtMail0,
        SeptemberUserBoughtMail0,
        OctoberUserBoughtMail0,
        NovemberUserBoughtMail0,
        DecemberUserBoughtMail0
    ]
    let datasetchartmaille = {
        label: 'Label 1',
        data: mailData,
        backgroundColor: [
            'rgba(93, 251, 0, 0.2)'
        ],
        borderWidth: 0
    };
    const myChartMaillesChart = new Chart(ctxMailleChart, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Label 2',
                    data: [],
                    backgroundColor: [
                        'rgba(153, 142, 255, 0.2)'
                    ],
                    borderWidth: 0
                },
                datasetchartmaille
            ]
        },
        options: {
            scales: {
                x: {
                    grid: {
                        display: false,
                    },
                    stacked: true
                },
                y: {
                    grid: {
                        display: false,
                    },
                    beginAtZero: true,
                    stacked: true
                }
            }
        }
    });
    // myChart.canvas.parentNode.style.height = '100%';
    // myChart.parentNode.backgroundColor = 'white';
    // myChart.canvas.style.height = '70%';
    // myChart.canvas.style.width = '70%';
    myChart.canvas.style.backgroundColor = '#FFF';
    myChartLineChart.canvas.style.backgroundColor = '#FFF';
    myChartMaillesChart.canvas.style.backgroundColor = '#FFF';

</script>

{% endblock %}